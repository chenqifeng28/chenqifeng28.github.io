<?xml version="1.0" encoding="utf-8"?>
<search> 
  
    
    <entry>
      <title><![CDATA[基于KVM虚拟化的管理工具--oVirt搭建]]></title>
      <url>/2017/10/29/oVirt_install/</url>
      <content type="html"><![CDATA[<p>首先，需要准备两台内核在3.10以上的Linux服务器，这里以CentOS 7.4为例。两台服务器的IP地址和主机名分别为：<br>node1.test.com—-&gt;192.168.10.10—-oVirt管理端<br>node2.test.com—-&gt;192.168.10.11—-KVM虚拟化物理机<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">[root@node1 ~]# hostname</div><div class="line">node1.test.com</div><div class="line">[root@node1 ~]# uname -a</div><div class="line">Linux node1.test.com 3.10.0-693.el7.x86_64 #1 SMP Tue Aug 22 21:09:27 UTC 2017 x86_64 x86_64 x86_64 GNU/Linux</div><div class="line">[root@node1 ~]# ifconfig |head -n 3</div><div class="line">ens32: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500</div><div class="line">        inet 192.168.10.10  netmask 255.255.255.0  broadcast 192.168.10.255</div><div class="line">        inet6 fe80::87e3:3b58:665:5b96  prefixlen 64  scopeid 0x20&lt;link&gt;</div></pre></td></tr></table></figure></p>
<p>服务器配置好后，需要将SELinux、firewalld关闭，并且配置好yum源，建议采用aliyun的yum源。</p>
<h2 id="Ovirt介绍"><a href="#Ovirt介绍" class="headerlink" title="Ovirt介绍"></a>Ovirt介绍</h2><p>目前oVirt的最新版本为oVirt 4.1,这里以安装4.1为例</p>
<hr>
<p>Install oVirt using package manager<br>oVirt 4.1 is intended for production use and is available for the following platforms:</p>
<p>Fedora 24<br>Red Hat Enterprise Linux 7.4 or later<br>CentOS Linux 7.4 or later<br>Scientific Linux 7.4 or later<br>Our recommended method of installing oVirt is to use the pre-built packages for Fedora or a supported Enterprise Linux 7 distribution, such as CentOS Linux or Red Hat Enterprise Linux. This makes installing oVirt very easy.</p>
<p>Important: Please note you can not skip a version. If you are updating from e.g. 3.6, you first need to update to 4.0 and then to 4.1. If you’re upgrading from a previous version, please update ovirt-release40 and verify you have the correct repositories enabled by running the following commands before upgrading with the usual procedure.<br>[root@test ~]yum install <a href="http://resources.ovirt.org/pub/yum-repo/ovirt-release41.rpm" target="_blank" rel="external">http://resources.ovirt.org/pub/yum-repo/ovirt-release41.rpm</a> </p>
<p>You should also read the Release Notes for oVirt 4.1.6.</p>
<hr>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div></pre></td><td class="code"><pre><div class="line">[root@node1 ~]# yum install http://resources.ovirt.org/pub/yum-repo/ovirt-release41.rpm </div><div class="line">Loaded plugins: fastestmirror, langpacks</div><div class="line">ovirt-release41.rpm                                                                  |  15 kB  00:00:00     </div><div class="line">Examining /var/tmp/yum-root-DiNHCq/ovirt-release41.rpm: ovirt-release41-4.1.6-1.el7.centos.noarch</div><div class="line">Marking /var/tmp/yum-root-DiNHCq/ovirt-release41.rpm to be installed</div><div class="line">Resolving Dependencies</div><div class="line">--&gt; Running transaction check</div><div class="line">---&gt; Package ovirt-release41.noarch 0:4.1.6-1.el7.centos will be installed</div><div class="line">--&gt; Finished Dependency Resolution</div><div class="line">base/7/x86_64                                                                        | 3.6 kB  00:00:00     </div><div class="line">base/7/x86_64/group_gz                                                               | 156 kB  00:00:00     </div><div class="line">base/7/x86_64/primary_db                                                             | 5.7 MB  00:00:00     </div><div class="line">centosplus/7/x86_64                                                                  | 3.4 kB  00:00:00     </div><div class="line">centosplus/7/x86_64/primary_db                                                       | 1.8 MB  00:00:00     </div><div class="line">extras/7/x86_64                                                                      | 3.4 kB  00:00:00     </div><div class="line">extras/7/x86_64/primary_db                                                           | 129 kB  00:00:00     </div><div class="line">updates/7/x86_64                                                                     | 3.4 kB  00:00:00     </div><div class="line">updates/7/x86_64/primary_db                                                          | 3.6 MB  00:00:00     </div><div class="line"></div><div class="line">Dependencies Resolved</div><div class="line"></div><div class="line">============================================================================================================</div><div class="line"> Package                   Arch             Version                        Repository                  Size</div><div class="line">============================================================================================================</div><div class="line">Installing:</div><div class="line"> ovirt-release41           noarch           4.1.6-1.el7.centos             /ovirt-release41            10 k</div><div class="line"></div><div class="line">Transaction Summary</div><div class="line">============================================================================================================</div><div class="line">Install  1 Package</div><div class="line"></div><div class="line">Total size: 10 k</div><div class="line">Installed size: 10 k</div><div class="line">Is this ok [y/d/N]: y</div><div class="line">Downloading packages:</div><div class="line">Running transaction check</div><div class="line">Running transaction test</div><div class="line">Transaction test succeeded</div><div class="line">Running transaction</div><div class="line">  Installing : ovirt-release41-4.1.6-1.el7.centos.noarch                                                1/1 </div><div class="line">  Verifying  : ovirt-release41-4.1.6-1.el7.centos.noarch                                                1/1 </div><div class="line"></div><div class="line">Installed:</div><div class="line">  ovirt-release41.noarch 0:4.1.6-1.el7.centos                                                               </div><div class="line"></div><div class="line">Complete!</div><div class="line">[root@node1 ~]#</div></pre></td></tr></table></figure>
<p>ovirt 4.1安装好之后，需要在node1（oVirt管理端）上安装oVirt-engine，安装oVirt-engine有100多个包需要安装，耗费的时间就会稍微久一点。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[root@node1 ~]# yum install ovirt-engine</div></pre></td></tr></table></figure></p>
<p>等ovirt-engine相关的包安装完成之后则，运行engine-setup开始安装配置oVirt<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[root@node1 ~]# engine-setup</div></pre></td></tr></table></figure></p>
<p>具体的配置如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div></pre></td><td class="code"><pre><div class="line">[root@node1 ~]# engine-setup </div><div class="line">[ INFO  ] Stage: Initializing</div><div class="line">[ INFO  ] Stage: Environment setup</div><div class="line">          Configuration files: [&apos;/etc/ovirt-engine-setup.conf.d/10-packaging-jboss.conf&apos;, &apos;/etc/ovirt-engine-setup.conf.d/10-packaging.conf&apos;]</div><div class="line">          Log file: /var/log/ovirt-engine/setup/ovirt-engine-setup-20171030000600-sb0rsz.log</div><div class="line">          Version: otopi-1.6.2 (otopi-1.6.2-1.el7.centos)</div><div class="line">[ INFO  ] Stage: Environment packages setup</div><div class="line">[ INFO  ] Yum Downloading: ovirt-4.1/7 (0%)</div><div class="line">[ INFO  ] Stage: Programs detection</div><div class="line">[ INFO  ] Stage: Environment setup</div><div class="line">[ INFO  ] Stage: Environment customization</div><div class="line">         </div><div class="line">          --== PRODUCT OPTIONS ==--</div><div class="line">         </div><div class="line">          Configure Engine on this host (Yes, No) [Yes]: yes</div><div class="line">          Configure Image I/O Proxy on this host? (Yes, No) [Yes]: yes</div><div class="line">          Configure WebSocket Proxy on this host (Yes, No) [Yes]: yes</div><div class="line">          Please note: Data Warehouse is required for the engine. If you choose to not configure it on this host, you have to configure it on a remote host, and then configure the engine on this host so that it can access the database of the remote Data Warehouse host.</div><div class="line">          Configure Data Warehouse on this host (Yes, No) [Yes]: yes</div><div class="line">          Configure VM Console Proxy on this host (Yes, No) [Yes]: yes</div><div class="line">         </div><div class="line">          --== PACKAGES ==--</div><div class="line">         </div><div class="line">[ INFO  ] Checking for product updates...</div><div class="line">[ INFO  ] No product updates found</div><div class="line">         </div><div class="line">          --== NETWORK CONFIGURATION ==--</div><div class="line">         </div><div class="line">          Host fully qualified DNS name of this server [node1.test.com]: </div><div class="line">          Setup can automatically configure the firewall on this system.</div><div class="line">          Note: automatic configuration of the firewall may overwrite current settings.</div><div class="line">          Do you want Setup to configure the firewall? (Yes, No) [Yes]: yes</div><div class="line">          The following firewall managers were detected on this system: firewalld</div><div class="line">          Firewall manager to configure (firewalld): firewalld</div><div class="line">[ INFO  ] firewalld will be configured as firewall manager.</div><div class="line">         </div><div class="line">          --== DATABASE CONFIGURATION ==--</div><div class="line">         </div><div class="line">          Where is the DWH database located? (Local, Remote) [Local]: </div><div class="line">          Setup can configure the local postgresql server automatically for the DWH to run. This may conflict with existing applications.</div><div class="line">          Would you like Setup to automatically configure postgresql and create DWH database, or prefer to perform that manually? (Automatic, Manual) [Automatic]: </div><div class="line">          Where is the Engine database located? (Local, Remote) [Local]: </div><div class="line">          Setup can configure the local postgresql server automatically for the engine to run. This may conflict with existing applications.</div><div class="line">          Would you like Setup to automatically configure postgresql and create Engine database, or prefer to perform that manually? (Automatic, Manual) [Automatic]: </div><div class="line">         </div><div class="line">          --== OVIRT ENGINE CONFIGURATION ==--</div><div class="line">         </div><div class="line">          Engine admin password: </div><div class="line">          Confirm engine admin password: </div><div class="line">[WARNING] Password is weak: it is too short</div><div class="line">          Use weak password? (Yes, No) [No]: yes</div><div class="line">          Application mode (Virt, Gluster, Both) [Both]: </div><div class="line">         </div><div class="line">          --== STORAGE CONFIGURATION ==--</div><div class="line">         </div><div class="line">          Default SAN wipe after delete (Yes, No) [No]: </div><div class="line">         </div><div class="line">          --== PKI CONFIGURATION ==--</div><div class="line">         </div><div class="line">          Organization name for certificate [test.com]: </div><div class="line">         </div><div class="line">          --== APACHE CONFIGURATION ==--</div><div class="line">         </div><div class="line">          Setup can configure the default page of the web server to present the application home page. This may conflict with existing applications.</div><div class="line">          Do you wish to set the application as the default page of the web server? (Yes, No) [Yes]: </div><div class="line">          Setup can configure apache to use SSL using a certificate issued from the internal CA.</div><div class="line">          Do you wish Setup to configure that, or prefer to perform that manually? (Automatic, Manual) [Automatic]: </div><div class="line">         </div><div class="line">          --== SYSTEM CONFIGURATION ==--</div><div class="line">         </div><div class="line">          Configure an NFS share on this server to be used as an ISO Domain? (Yes, No) [No]: </div><div class="line">         </div><div class="line">          --== MISC CONFIGURATION ==--</div><div class="line">         </div><div class="line">          Please choose Data Warehouse sampling scale:</div><div class="line">          (1) Basic</div><div class="line">          (2) Full</div><div class="line">          (1, 2)[1]: </div><div class="line">         </div><div class="line">          --== END OF CONFIGURATION ==--</div><div class="line">         </div><div class="line">[ INFO  ] Stage: Setup validation</div><div class="line">[WARNING] Cannot validate host name settings, reason: resolved host does not match any of the local addresses</div><div class="line">[WARNING] Less than 16384MB of memory is available</div><div class="line">         </div><div class="line">          --== CONFIGURATION PREVIEW ==--</div><div class="line">         </div><div class="line">          Application mode                        : both</div><div class="line">          Default SAN wipe after delete           : False</div><div class="line">          Firewall manager                        : firewalld</div><div class="line">          Update Firewall                         : True</div><div class="line">          Host FQDN                               : node1.test.com</div><div class="line">          Configure local Engine database         : True</div><div class="line">          Set application as default page         : True</div><div class="line">          Configure Apache SSL                    : True</div><div class="line">          Engine database secured connection      : False</div><div class="line">          Engine database user name               : engine</div><div class="line">          Engine database name                    : engine</div><div class="line">          Engine database host                    : localhost</div><div class="line">          Engine database port                    : 5432</div><div class="line">          Engine database host name validation    : False</div><div class="line">          Engine installation                     : True</div><div class="line">          PKI organization                        : test.com</div><div class="line">          DWH installation                        : True</div><div class="line">          DWH database secured connection         : False</div><div class="line">          DWH database host                       : localhost</div><div class="line">          DWH database user name                  : ovirt_engine_history</div><div class="line">          DWH database name                       : ovirt_engine_history</div><div class="line">          DWH database port                       : 5432</div><div class="line">          DWH database host name validation       : False</div><div class="line">          Configure local DWH database            : True</div><div class="line">          Configure Image I/O Proxy               : True</div><div class="line">          Configure VMConsole Proxy               : True</div><div class="line">          Configure WebSocket Proxy               : True</div><div class="line">         </div><div class="line">          Please confirm installation settings (OK, Cancel) [OK]: </div><div class="line">[ INFO  ] Stage: Transaction setup</div><div class="line">[ INFO  ] Stopping engine service</div><div class="line">[ INFO  ] Stopping ovirt-fence-kdump-listener service</div><div class="line">[ INFO  ] Stopping dwh service</div><div class="line">[ INFO  ] Stopping Image I/O Proxy service</div><div class="line">[ INFO  ] Stopping vmconsole-proxy service</div><div class="line">[ INFO  ] Stopping websocket-proxy service</div><div class="line">[ INFO  ] Stage: Misc configuration</div><div class="line">[ INFO  ] Stage: Package installation</div><div class="line">[ INFO  ] Stage: Misc configuration</div><div class="line">[ INFO  ] Upgrading CA</div><div class="line">[ INFO  ] Initializing PostgreSQL</div><div class="line">[ INFO  ] Creating PostgreSQL &apos;engine&apos; database</div><div class="line">[ INFO  ] Configuring PostgreSQL</div><div class="line">[ INFO  ] Creating PostgreSQL &apos;ovirt_engine_history&apos; database</div><div class="line">[ INFO  ] Configuring PostgreSQL</div><div class="line">[ INFO  ] Creating CA</div><div class="line">[ INFO  ] Creating/refreshing Engine database schema</div><div class="line">[ INFO  ] Creating/refreshing DWH database schema</div><div class="line">[ INFO  ] Configuring Image I/O Proxy</div><div class="line">[ INFO  ] Setting up ovirt-vmconsole proxy helper PKI artifacts</div><div class="line">[ INFO  ] Setting up ovirt-vmconsole SSH PKI artifacts</div><div class="line">[ INFO  ] Configuring WebSocket Proxy</div><div class="line">[ INFO  ] Creating/refreshing Engine &apos;internal&apos; domain database schema</div><div class="line">[ INFO  ] Generating post install configuration file &apos;/etc/ovirt-engine-setup.conf.d/20-setup-ovirt-post.conf&apos;</div><div class="line">[ INFO  ] Stage: Transaction commit</div><div class="line">[ INFO  ] Stage: Closing up</div><div class="line">[ INFO  ] Starting engine service</div><div class="line">[ INFO  ] Starting dwh service</div><div class="line">[ INFO  ] Restarting ovirt-vmconsole proxy service</div><div class="line">         </div><div class="line">          --== SUMMARY ==--</div><div class="line">         </div><div class="line">[ INFO  ] Restarting httpd</div><div class="line">          Please use the user &apos;admin@internal&apos; and password specified in order to login</div><div class="line">          Web access is enabled at:</div><div class="line">              http://node1.test.com:80/ovirt-engine</div><div class="line">              https://node1.test.com:443/ovirt-engine</div><div class="line">          Internal CA C0:3E:00:3D:58:19:12:59:F2:B2:F8:DE:0A:1F:E7:BD:40:D4:21:38</div><div class="line">          SSH fingerprint: SHA256:CZZ7FrwMob5cwQJHyMVbQ5EoGujq1oV3cTr9pWRQ8Lw</div><div class="line">[WARNING] Less than 16384MB of memory is available</div><div class="line">         </div><div class="line">          --== END OF SUMMARY ==--</div><div class="line">         </div><div class="line">[ INFO  ] Stage: Clean up</div><div class="line">          Log file is located at /var/log/ovirt-engine/setup/ovirt-engine-setup-20171030000600-sb0rsz.log</div><div class="line">[ INFO  ] Generating answer file &apos;/var/lib/ovirt-engine/setup/answers/20171030001057-setup.conf&apos;</div><div class="line">[ INFO  ] Stage: Pre-termination</div><div class="line">[ INFO  ] Stage: Termination</div><div class="line">[ INFO  ] Execution of setup completed successfully</div><div class="line">[root@node1 ~]#</div></pre></td></tr></table></figure></p>
<hr>
<p>至此，oVirt已经安装完成，需要打开浏览器，输入下面的网址打开oVirt的控制台界面，然后输入账号和密码登陆即可。<br><a href="http://node1.test.com:80/ovirt-engine" target="_blank" rel="external">http://node1.test.com:80/ovirt-engine</a><br><a href="https://node1.test.com:443/ovirt-engine" target="_blank" rel="external">https://node1.test.com:443/ovirt-engine</a></p>
]]></content>
      
        <categories>
            
            <category> Technology </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Technology </tag>
            
            <tag> oVirt </tag>
            
            <tag> KVM </tag>
            
            <tag> Virtualmachine </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[性能收集工具--NMON的部署使用]]></title>
      <url>/2017/10/29/nmon_tools/</url>
      <content type="html"><![CDATA[<hr>
<p>Nmon 是一个分析AIX和Linux性能的免费工具（其主要是IBM为自己的AIX操作系统开发的，但是也可以应用在Linux操作系统上），而nmon_analyser是nmon的一个工具可以把nmon生成的报告转化成Excel报表的形式供我们查看。</p>
<hr>
<h4 id="下载nmon软件"><a href="#下载nmon软件" class="headerlink" title="下载nmon软件"></a>下载nmon软件</h4><hr>
<p>打开浏览器输入：<a href="http://nmon.sourceforge.net/pmwiki.php，" target="_blank" rel="external">http://nmon.sourceforge.net/pmwiki.php，</a> 然后后点击“Download Binaries”，根据自己操作系统的版本下载对应版本的nmon工具。（这里以操作系统版本为 Redhat Enterprise Linux 6.8 X86_64版本为例，选在下载的安装包为 nmon16e_mpginc.tar.gz ）</p>
<hr>
<h4 id="安装nmon工具"><a href="#安装nmon工具" class="headerlink" title="安装nmon工具"></a>安装nmon工具</h4><hr>
<p>将下载的安装包nmon16e_mpginc.tar.gz上传到linux服务器中，然后解压缩。</p>
<hr>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line">[root@host ~]# ls</div><div class="line">nmon16e_mpginc.tar.gz</div><div class="line">[root@host ~]# tar -xzvf nmon16e_mpginc.tar.gz </div><div class="line">nmon_arm_ubuntu15</div><div class="line">nmon_power_32_rhel6</div><div class="line">nmon_power_32_sles11</div><div class="line">nmon_power_64_kvm2</div><div class="line">nmon_power_64_rhel6</div><div class="line">nmon_power_64_rhel7</div><div class="line">nmon_power_64_sles11</div><div class="line">nmon_power_64le_fedora22</div><div class="line">nmon_power_64le_rhel6</div><div class="line">nmon_power_64le_rhel7</div><div class="line">nmon_power_64le_ubuntu14</div><div class="line">nmon_power_64le_ubuntu15</div><div class="line">nmon_power_64le_ubuntu16</div><div class="line">nmon_x86_64_centos6</div><div class="line">nmon_x86_64_centos7</div><div class="line">nmon_x86_64_opensuse11</div><div class="line">nmon_x86_64_opensuse12</div><div class="line">nmon_x86_64_rhel6</div><div class="line">nmon_x86_64_rhel7</div><div class="line">nmon_x86_64_sles11</div><div class="line">nmon_x86_64_sles12</div><div class="line">nmon_x86_64_ubuntu15</div><div class="line">[root@host ~]#</div><div class="line">*****</div></pre></td></tr></table></figure>
<p>选择对应的执行文件nmon_x86_64_rhel6，查看该文件的权限。给该文件赋予可执行的权限。</p>
<hr>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">[root@host ~]# ll nmon_x86_64_rhel6 </div><div class="line">-rwxr----- 1 root root 347506 Apr 14  2016 nmon_x86_64_rhel6</div><div class="line">[root@host ~]# chmod +x nmon_x86_64_rhel6</div><div class="line">[root@host ~]# ll nmon_x86_64_rhel6 </div><div class="line">-rwxr-x--x 1 root root 347506 Apr 14  2016 nmon_x86_64_rhel6</div></pre></td></tr></table></figure>
<hr>
<p>为了确保nmon执行后有个固定的目录存放收集到的nmon数据，需要新建一个目录用于保存。然后将rhel6的nmon执行文件移到该目录下。</p>
<hr>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">[root@host /]# mkdir -p /nmon/nmon_x86_64_linux6</div><div class="line">[root@host ~]# mv nmon_x86_64_rhel6 /nmon/nmon_x86_64_linux6/</div></pre></td></tr></table></figure>
<hr>
<p>然后定义一个脚本用于每天定时执行该脚本收集服务器的性能数据</p>
<hr>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">[root@host nmon_x86_64_linux6]# mkdir day</div><div class="line">[root@host nmon_x86_64_linux6]# cd day/</div><div class="line">[root@host day]# pwd</div><div class="line">/nmon/nmon_x86_64_linux6/day</div><div class="line">[root@host day]# cat nmon_day.sh </div><div class="line">#!/bin/bash</div><div class="line">mkdir /nmon/day/</div><div class="line">cd /nmon/day</div><div class="line">gzip *.nmon</div><div class="line">find /nmon/nmon_x86_64_linux6/day/* -mtime 7 -exec rm &#123; &#125; \;</div><div class="line">/nmon/nmon_x86_64_linux6/nmon_x86_64_rhel6 -fdt -s 300 -c 288</div></pre></td></tr></table></figure>
<hr>
<p>说明：nmon_day.sh是用来每天定时执行nmon的脚本，里面定义了nmon收集性能的颗粒度，范例是以每5分钟收集一次（5min*60sec）,然后总共收集288次（即收集一天的数据）；另外范例还定义了nmon数据保存的生命周期，当nmon保存的时间超过7天则删除该数据；同时在第二天启动该脚本时会自动将第一天的数据进行打包。<br>然后将该脚本添加到crontab钟，定义每天早上8点自动执行该脚本。</p>
<hr>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">[root@host nmon_x86_64_linux6]# crontab -l</div><div class="line">00 08 * * * /nmon/nmon_x86_64_linux6/day/nmon_day.sh</div></pre></td></tr></table></figure>
<h4 id="nmon分析工具–nmon-analyser"><a href="#nmon分析工具–nmon-analyser" class="headerlink" title="nmon分析工具–nmon_analyser"></a>nmon分析工具–nmon_analyser</h4><hr>
<p>首先需要从IBM的网站下载nmon Analyser，网址：<br><a href="https://www.ibm.com/developerworks/community/wikis/home?lang=en#!/wiki/Power+Systems/page/nmon_analyser" target="_blank" rel="external">https://www.ibm.com/developerworks/community/wikis/home?lang=en#!/wiki/Power+Systems/page/nmon_analyser</a>.<br>Nmon_Analyser下载下来后就是一个Excel，但是这个Excel就是我们需要的工具了。双击打开这个Excel文件，点击“Analyze nmon data”，然后选择我们刚才生成的nmon文件，大概十几秒左右（数据量不同，生成的时间也不一样）就会生成我们需要的报表了。此时我们就可以更加直观的观看CPU，内存等数据了。</p>
<hr>
<h4 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h4><hr>
<p>nmon analyser需要借助Excel的宏，当弹出“启用宏”还是“禁用宏”时，需要选择“启用宏”，然后点击“Analyze nmon data”，选择你收集到的*.nmon文件进行分析，最后得到的.xlsx就是分析后的结果，里面将会呈现该服务器在CPU、内存、IO、文件使用等相关性能信息。</p>
<hr>
]]></content>
      
        <categories>
            
            <category> Tools </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Tools </tag>
            
            <tag> nmon </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Hello World]]></title>
      <url>/2017/10/19/hello-world/</url>
      <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/" target="_blank" rel="external">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank" rel="external">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="external">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="external">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo new <span class="string">"My New Post"</span></div></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="external">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo server</div></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/server.html" target="_blank" rel="external">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo generate</div></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/generating.html" target="_blank" rel="external">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo deploy</div></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/deployment.html" target="_blank" rel="external">Deployment</a></p>
]]></content>
      
        
    </entry>
    
  
  
    
    <entry>
      <title><![CDATA[分类]]></title>
      <url>/categories/index.html</url>
      <content type="html"></content>
    </entry>
    
    <entry>
      <title><![CDATA[标签]]></title>
      <url>/tags/index.html</url>
      <content type="html"></content>
    </entry>
    
  
</search>
